// Intravenous JavaScript library v0.1.0-beta
// (c) Roy Jacobs
// License: MIT (http://www.opensource.org/licenses/mit-license.php)

(function(window,document,navigator,undefined){
var j=null;function o(h){function p(m,n){for(var i=m.split("."),k=h,l=0;l<i.length-1;l++)k=k[i[l]];k[i[i.length-1]]=n}h="undefined"!==typeof h?h:{};h.version="0.1.0-beta";p("version",h.version);(function(){function m(a,b,d){for(var c=n(a,b),b=c.key,c=c.data,f,g=a;g&&!(f=g.h[b]);)g=g.parent;if(c&&c.l){var e=c.l(a,b,f);if(e.e)return e.data}if(!g)throw Error("Unknown dependency: "+b);if(c&&c.q&&(e=c.q(a,b,f),e.e))return e.data;if(e=a.c[f.n].get(b))return e;if(f.value instanceof Function){e=f.value.t;b=[];if(e instanceof
Array){c=0;for(g=e.length;c<g;c++)b.push(m(a,e[c],[]))}c=function(){};c.prototype=f.value.prototype;e=new c;c=0;for(g=d.length;c<g;c++)b.push(d[c]);f.value.apply(e,b)}else e=f.value;a.c[f.n].set(new t(f,e));return e}function n(a,b){for(var d in a.m)for(var c=a.m[d],f=0,g=c.suffixes.length;f<g;f++){var e=c.suffixes[f];if(-1!==b.indexOf(e,b.length-e.length))return{data:c,key:b.slice(0,b.length-e.length)}}return{data:j,key:b}}function i(a,b){this.h={};this.parent=b;this.c={v:new q(this),w:new r(this),
unique:new s(this)};this.children=[];this.options=a=a||{};this.r("container",this)}function k(a,b){this.b=a;this.key=b}function l(a,b){this.b=a.create();this.key=b}function s(a){this.b=a;this.a=[]}function r(a){this.b=a;this.a=[]}function q(a){this.b=a;this.a=[];this.p={};this.d=0;this.j={};this.k=[]}function t(a,b){this.g=a;this.f=b}function u(a,b,d,c){this.key=a;this.b=b;this.value=d;this.n=c}q.prototype={get:function(a){for(var b=0,d=this.a.length;b<d;b++){var c=this.a[b];if(c.g.key===a&&c.d===
this.d){if(!c.f)break;this.set(c);return c.f}}this.k.push(a);if(this.j[a])throw Error("Circular reference: "+this.k.join(" --\> "));this.j[a]=!0;return j},set:function(a){this.a.push(a);this.p[a.g.key]=this.p[a.g.key]++||1;a.d=this.d},i:function(){this.d++;this.j={};this.k=[]}};r.prototype={get:function(a){for(var b=0,d=this.a.length;b<d;b++){var c=this.a[b];if(c.g.key===a){if(!c.f)break;this.set(c);return c.f}}return j},set:function(a){this.a.push(a)},i:function(){}};s.prototype={get:function(){return j},
set:function(a){this.a.push(a)},i:function(){}};l.prototype={get:function(){var a=Array.prototype.slice.call(arguments);a.unshift(this.key);a=this.b.get.apply(this.b,a);a.s=this;return a}};k.prototype={get:function(){var a=new l(this.b,this.key);return a.get.apply(a,arguments)}};i.prototype={m:{u:{suffixes:["?"],l:function(a,b,d){return d?{e:!1}:{e:!0,data:j}}},factory:{suffixes:["Factory","!"],q:function(a,b){return{e:!0,data:new k(a,b)}}}},r:function(a,b,d){if(n(this,a).data)throw Error("Cannot register dependency: "+
a);!d&&this.h[a]?this.h[a].value=b:this.h[a]=new u(a,this,b,d||"perRequest")},get:function(a){for(var b in this.c)this.c.hasOwnProperty(b)&&this.c[b].i(a);b=Array.prototype.slice.call(arguments).slice(1);for(var d=this,c;d&&(c=m(d,a,b))===j;)d=d.parent;return c},create:function(a){a=a||{};a.o=a.o||this.options.o;a=new i(a,this);this.children.push(a);return a}};h.create=function(a){return new i(a)};p("create",h.create)})()}
"function"===typeof require&&"object"===typeof exports&&"object"===typeof module?o(module.exports||exports):"function"===typeof define&&define.amd?define(["exports"],o):o(window.intravenous={});!0;
})(window,document,navigator);
